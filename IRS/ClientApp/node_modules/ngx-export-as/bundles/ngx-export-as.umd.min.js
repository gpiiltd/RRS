!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("html2canvas"),require("xlsx"),require("html-docx-js/dist/html-docx"),require("html2pdf.js")):"function"==typeof define&&define.amd?define("ngx-export-as",["exports","@angular/core","rxjs","html2canvas","xlsx","html-docx-js/dist/html-docx","html2pdf.js"],t):t(e["ngx-export-as"]={},e.ng.core,e.rxjs,e.html2canvas,e.XLSX,e.htmlDocx,e.html2pdf)}(this,function(e,t,o,a,s,l,r){"use strict";a=a&&a.hasOwnProperty("default")?a["default"]:a,r=r&&r.hasOwnProperty("default")?r["default"]:r,window.html2canvas=a;var n=function(){function e(){}return e.prototype.get=function(e){var t="get"+e.type.toUpperCase();return this[t]?this[t](e):o.Observable.create(function(e){e.error("Export type is not supported.")})},e.prototype.save=function(e,t){e.download=!0,e.fileName=t+"."+e.type,this.get(e).subscribe()},e.prototype.contentToBlob=function(l){return o.Observable.create(function(e){for(var t=l.split(","),o=t[0].match(/:(.*?);/)[1],n=atob(t[1]),r=n.length,a=new Uint8Array(r);r--;)a[r]=n.charCodeAt(r);e.next(new Blob([a],{type:o})),e.complete()})},e.prototype.removeFileTypeFromBase64=function(e){return/^data:[^]*;base64,/g[Symbol.replace](e,"")},e.prototype.addFileTypeToBase64=function(e,t){return"data:"+t+";base64,"+e},e.prototype.downloadFromDataURL=function(t,e){var o=this;this.contentToBlob(e).subscribe(function(e){o.downloadFromBlob(e,t)})},e.prototype.downloadFromBlob=function(e,t){var o=window.URL.createObjectURL(e);if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,t);else{var n=document.createElement("a");n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.href=o,n.click(),document.body.removeChild(n)}},e.prototype.getPDF=function(n){return o.Observable.create(function(t){n.options||(n.options={}),n.options.filename=n.fileName;var e=document.getElementById(n.elementId),o=r().set(n.options).from(e,"element");n.download?(o.save(),t.next(),t.complete()):o.outputPdf("datauristring").then(function(e){t.next(e),t.complete()})})},e.prototype.getPNG=function(n){var r=this;return o.Observable.create(function(o){var e=document.getElementById(n.elementId);a(e,n.options).then(function(e){var t=e.toDataURL("image/PNG");"png"===n.type&&n.download?(r.downloadFromDataURL(n.fileName,t),o.next()):o.next(t),o.complete()},function(e){o.error(e)})})},e.prototype.getCSV=function(d){var c=this;return o.Observable.create(function(e){for(var t=[],o=document.getElementById(d.elementId).querySelectorAll("table tr"),n=0;n<o.length;n++){for(var r=[],a=o[n].querySelectorAll("td, th"),l=0;l<a.length;l++){var s=a[l];r.push(s.innerText)}t.push(r.join(","))}var i="data:text/csv;base64,"+c.btoa(t.join("\n"));d.download?(c.downloadFromDataURL(d.fileName,i),e.next()):e.next(i),e.complete()})},e.prototype.getTXT=function(e){var t=e.fileName.split(".");return e.fileName=t[0]+".txt",this.getCSV(e)},e.prototype.getXLS=function(a){var l=this;return o.Observable.create(function(e){var t=document.getElementById(a.elementId),o=s.utils.table_to_sheet(t,a.options),n=s.utils.book_new();s.utils.book_append_sheet(n,o,a.fileName);var r="data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+s.write(n,{type:"base64"});a.download?(l.downloadFromDataURL(a.fileName,r),e.next()):e.next(r),e.complete()})},e.prototype.getXLSX=function(e){return this.getXLS(e)},e.prototype.getDOCX=function(r){var a=this;return o.Observable.create(function(t){var e="<!DOCTYPE html>"+document.getElementById(r.elementId).outerHTML,o=l.asBlob(e,r.options);if(r.download)a.downloadFromBlob(o,r.fileName),t.next(),t.complete();else{var n=new FileReader;n.onloadend=function(){var e=n.result;t.next(e),t.complete()},n.readAsDataURL(o)}})},e.prototype.getDOC=function(e){return this.getDOCX(e)},e.prototype.getJSON=function(p){var u=this;return o.Observable.create(function(e){for(var t=[],o=[],n=document.getElementById(p.elementId),r=0;r<n.rows[0].cells.length;r++)o[r]=n.rows[0].cells[r].innerHTML.toLowerCase().replace(/ /gi,"");for(var a=1;a<n.rows.length;a++){for(var l=n.rows[a],s={},i=0;i<l.cells.length;i++)s[o[i]]=l.cells[i].innerHTML;t.push(s)}var d=JSON.stringify(t),c="data:text/json;base64,"+u.btoa(d);p.download?(u.downloadFromDataURL(p.fileName,c),e.next()):e.next(t),e.complete()})},e.prototype.getXML=function(s){var i=this;return o.Observable.create(function(e){for(var t='<?xml version="1.0" encoding="UTF-8"?><Root><Classes>',o=document.getElementById(s.elementId).getElementsByTagName("tr"),n=0;n<o.length;n++){var r=o[n];if(0<r.cells.length){t+='<Class name="'+r.cells[0].textContent+'">\n';for(var a=1;a<r.cells.length;++a)t+="\t<data>"+r.cells[a].textContent+"</data>\n";t+="</Class>\n"}}t+="</Classes></Root>";var l="data:text/xml;base64,"+i.btoa(t);s.download?(i.downloadFromDataURL(s.fileName,l),e.next()):e.next(l),e.complete()})},e.prototype.btoa=function(e){return btoa(unescape(encodeURIComponent(e)))},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[]},e}(),i=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{providers:[n]}]}],e}();e.ExportAsService=n,e.ExportAsModule=i,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-export-as.umd.min.js.map